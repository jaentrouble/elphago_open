# elphago
lostark elixir

## 확률 분배 공식

1. 나머지 확률들에 비례하여 배분한다.
    - 예를 들어 10% 확률을 20% / 30% / 40% 에서 끌어온다고 치면 (20/9)%, (30/9)%, (40/9)% 씩 감소시킨다.

2. 봉인을 진행할 경우, 봉인 이후에 일어나는 계산은 처음부터 가짓수가 (5-n)개만 있었다고 가정하고 '처음부터 모두 다시' 계산한다.

3. 연성 5단계가 된 경우, 이 또한 봉인 취급하여 뺀 상태로 재계산이 들어간다. https://www.youtube.com/live/PK9NA6Z4LNg?feature=share&t=11143 (포셔 풀영상 23/2/23 3:05:40 참고)
    - 이후 단계 소모 등으로 다시 강화가 가능해진 상태가 된 경우, 다시 포함하여 계산한다.

4. 확률감소로 0%가 된 것은 확률계산에서 제외하지 않는다. (포셔 풀영상 23/2/23 5:22:44 참고)

## 변수

- opt_prob_log
    - max 14단계까지, [idx, 확률변화값]
    - -1로 초기화, idx=-1 이면 아직 없는 것
    - 0부터 채워나간다.

## 조언

[조언 종류, param1, param2]

- param1 : 각 조언별 종류
- param2 : 어느 옵션에 해당하는지

## 참고
- 랜덤 증감에서 각 수치는 균등한(uniform)한 것으로 추측됨
- enchant_n은 1로 초기화 할 것

## 조언 종류

- 질서 및 혼돈 조언은 별도표기
- AttrType: 0=일반, 1=봉인, 2=소진이후, 3=질서3, 4=질서3(봉인), 6=혼돈6, 7=혼돈6(봉인)

0. 특수
    - param1 -> 0~7 : 아무 행동 안함, 8: 나오지 않음
        - 0: 조언 횟수 1회 증가 (질서 옵션)
        - 1: 조언 횟수 2회 증가 (질서 옵션)
        - 2: 기회 소모 없이 연성 (질서 옵션)
        - 3: 이번에 비용 소모 -100%
        - 4: 이후 항상 비용 소모 -20%
        - 5: 이후 항상 비용 소모 -40%
        - 6: 이후 항상 비용 소모 -100% (질서 옵션)
        - 7: 선택, 효과 랜덤 변경 (혼돈 옵션)
        - (8: 초기화 (혼돈 옵션) - 미구현)
        - (9: 휴식중 - 미구현, 정보전달용, advice idx -1로 표기)



1. 특정 옵션 증가감소
    - param1
        - 랜덤 증가감소
            - 0: -2 ~ +2 random
            - 1: -1 ~ +2 random
            (2,3 공백 -> 없던걸로 밝혀짐)
            - 4: +0 ~ +4 random (혼돈 옵션) (힘 소진) (adv 0에만 출현)
            - 5: +2 ~ +3 random (혼돈 옵션) (힘 소진) (adv 1에만 출현)
            - 6: -4 ~ +5 random (혼돈 옵션) (힘 소진) (adv 2에만 출현)
        - 확률로 증가
            - 7: +1 / 25% (선택 가능)
            - 8: +1 / 50% (선택 가능)
        - 확정 변동
            - 10: 임의의 하나 +1 (param2 무시)
            - 11: 임의의 하나 +2 (param2 무시) (혼돈 옵션)
            - 12: 최고단계 +1 (param2 무시)
            - 13: 최고단계 +2 (param2 무시) (질서 옵션)
            - 14: 최하단계 +1 (param2 무시)
            - 80: 최하단계 +2 (param2 무시) **번호주의 (나중에 추가됨)**

            - 81: 0단계 +1 (param2 무시) **번호주의 (나중에 추가됨)**
            - 15: 2단계 이하 +1 (param2 무시)
            - 16: 4단계 이하 +1 (param2 무시)
            - 17: 6단계 이하 +1 (param2 무시)

            - 18: +2, 기회 2회 소모

            - 19: 선택한 옵션 +1 (질서 옵션)
            - 20: 선택한 옵션 +2 (질서 옵션)

            - 21: 135 +1 24 -2
            - 22: 135 -2 24 +1
                
        - +1, -1
            - 30 + idx: param2의 옵션을 1 올리고, idx의 옵션을 1 내린다.
                - idx는 adv_get에서 처리할 것
            - 35: 최하단계 +1, 최고단계 -1 (param2 무시)
            - 36: 최하단계 +1, 임의 다른 하나 -1 (param2 무시)
            - 37: 최고단계 +1, 최하단계 -1 (param2 무시)
            - 38: 최고단계 +1, 임의 다른 하나 -1 (param2 무시)
        - +1, -2
            - 40 + idx: param2의 옵션을 1 올리고, idx의 옵션을 2 내린다.
                - idx는 adv_get에서 처리할 것
            - 45: 최하단계 +1, 최고단계 -2 (param2 무시)
            - 46: 최하단계 +1, 임의 다른 하나 -2 (param2 무시)
            - 47: 최고단계 +1, 최하단계 -2 (param2 무시)
            - 48: 최고단계 +1, 임의 다른 하나 -2 (param2 무시)
        - +2, -1
            - 50 + idx: param2의 옵션을 2 올리고, idx의 옵션을 1 내린다.
                - idx는 adv_get에서 처리할 것
            - 55: 최하단계 +2, 최고단계 -1 (param2 무시)
            - 56: 최하단계 +2, 임의 다른 하나 -1 (param2 무시)
        - +2, -2
            - 60 + idx: param2의 옵션을 2 올리고, idx의 옵션을 2 내린다.
                - idx는 adv_get에서 처리할 것
            - 65: 최하단계 +2, 최고단계 -2 (param2 무시)
            - 66: 최하단계 +2, 임의 다른 하나 -2 (param2 무시)

        - 확정
            - 70: 1 ~ 2 random (1~2로 해주겠네 계열) (1 ~ 4번째만 등장)
            - 71: 2 ~ 3 random (1~2로 해주겠네 계열) (5 ~ 9번째만 등장)
            - 72: 3 ~ 4 random (1~2로 해주겠네 계열) (9 ~ 12번째만 등장)
            - 73: 5 ~ 6 random (1~2로 해주겠네 계열) (13 ~ 번째만 등장)
        


2. 특정 옵션 확률 증가감소
    - param1
        - 이번에 (모두 선택 가능)
            - 0: 이번에 +100% (특정 옵션 확정 연성)
            - 1: 이번에 +70%
            - 2: 이번에 +35%
            - 3: 이번에 -20%
            - 4: 이번에 -40%
        - 이후 항상 (10~13 선택 가능)
            - 10: 이후 항상 +10%
            - 11: 이후 항상 +5%
            - 12: 이후 항상 -5%
            - 13: 이후 항상 -10%
            - 14: 선택, 이후 항상 +15% (질서 옵션)
            - 15: 선택, 이후 항상 -20% (질서 옵션)


3. 특정 옵션 대성공 확률 증가감소
    - param1
        - 이번에
            - 0: 이번에 모든 옵션 대성공 +60% (param2 무시)
            - 1: 이번에 모든 옵션 대성공 +30% (param2 무시)
            - 2: 이번에 대성공 +100% (선택 가능)

        - 이후 항상
            - 10: 선택, 이후 항상 대성공 +25% (질서 옵션)
            - 11: 이후 항상 대성공 +15% (선택 가능)
            - 12: 이후 항상 대성공 +7% (선택 가능)
            - 13: 이후 항상 모든 효과 대성공 +5% (param2 무시)
            - 14: 이후 항상 모든 효과 대성공 +10% (param2 무시)
            - 15: 이후 항상 2,4번 효과 대성공 +15% (param2 무시) (질서 옵션)
            - 16: 이후 항상 1,3,5번 효과 대성공 +15% (param2 무시) (질서 옵션)
            - 17: 이후 항상 모든 효과 대성공 +15% (param2 무시) (질서 옵션)

4. N회 연성 / N단계 연성
    - enchant_type
        - 0: 1회 연성 (default)
        - 1: 2개 동시연성
        - 2: 3개 동시연성
        - 3: 2단계 연성
        - 4: 3단계 연성
    - param1
        - 이번 연성에 (param2 무시)
            - 0: 이번에 2개 효과 동시연성 (대성공 별도)
            - 1: 이번에 3개 효과 동시연성, 기회 -2 (대성공 별도)
            - 2: 이번에 3개 효과 동시연성 (대성공 별도) (질서 옵션)
            - 3: 이번에 2단계 오름 (대성공 별도)
            - 4: 이번에 3단계 오름, 기회 -2 (대성공 별도)
            - 5: 이번에 3단계 오름 (대성공 별도) (질서 옵션)

        - 이번 연성에
            - 6: (param2)를 2단계 연성 (대성공 별도) (기회 2회 소모) (선택 가능)
            - 7: 선택, (param2)를 2단계 연성 (대성공 별도) (질서 옵션)

5. 옵션 교환
    - param1
        - 1개 깎고 교환
            - 0 + idx: (param2) -1, idx의 옵션과 교환
                - idx는 adv_get에서 처리할 것
            - 5: 최고단계 -1, 최하단계와 교환
        - 교환
            - 10 + idx: (param2)을 idx의 옵션과 교환
                - idx는 adv_get에서 처리할 것
            - 15: 최고단계, 최하단계와 교환
        - 혼돈 옵션
            - 20: 모든 효과 단계 섞음
            - 21: 모든 효과 단계 재분배
            - 22: 모든 효과 단계 아래로 1슬롯
            - 23: 모든 효과 단계 위로 1슬롯
            - 24: 효과 1개를 다른 효과에 임의로 분배 (선택 가능)
                - param2 0~4 : 선택, 5: 최고단계, 6: 최저단계
            - 25: 임의의 봉인을 임의로 옮기기 (혼돈 옵션)
            

6. 봉인
    - param1
        - 봉인 단계 (남은 연성 3~)
            - 일반 옵션
                - 0: (param2) 봉인
            - 질서 옵션
                - 10: 선택 봉인, 2개 효과 동시 연성 (대성공 별도)
                - 11: 선택 봉인, 2단계 연성 (대성공 별도)
                - 12: 선택 봉인, 기회 소모 X
            - 혼돈 옵션
                - 20: 선택 봉인, 모든 효과 단계 섞음
                - 21: 선택 봉인, 모든 효과 단계 재분배
                - 22: 선택 봉인, 임의의 하나 +1
                - 23: 선택 봉인, 최하단계 효과 +1

        - 비 봉인단계(남은 연성 ~4)
            - 30: 임의의 하나 봉인 (param2 무시)
            - 31: (param2) 봉인 (기회 2회 소모) (선택 가능)
            - 32: 선택 봉인 (질서 옵션)

